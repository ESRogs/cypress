<div id="container">
  <%= render :partial=>"shared/header" %>

  <div>
    <section class="tb">
      <%= link_to "Add EHR Vendor", new_vendor_path, {:class=>"cmd"} %>
      <%= link_to "Master Patient List", patients_path, {:class=>"cmd"} %>
      <nav class="breadcrumb">
        <span>Certification Dashboard</span>
      </nav>
    </section>

    <section class="candidate">  
      <p>
        Welcome to Cypress! This is the Certification Dashboard that indexes all EHR vendors that are being tested.
        <% if @vendors['pass'].empty? && @vendors['fail'].empty? %>
          To begin, click on the "Add EHR Vendor" button above.
        <% else %>
          Below you can see the current testing status of each one.
        <% end %>
      </p>
    </section>

    <section id="ehr_results">
      <table>
        <% @vendors.each do |result_status, result_vendors|
          next if result_vendors.empty? %>
          <thead>
            <tr>
              <th colspan="3"><span class="<%= result_status %>"><%= result_status %>ing</span> EHR Vendors</th>
              <th>Products</th>
              <th>POC</th>
              <th>Proctor</th>
              <th></th>
            </tr>
          </thead>
          <% result_vendors.each do |vendor| %>
            <% success_rate = vendor.success_rate
            dot_color = result_status
            dot_color = "na" if vendor.products.empty? %>
            <tbody>
              <tr>
                <td><div title="<%= success_rate %>%" class="<%= dot_color %>"><%= success_rate %></div></td>
                <td></td>
                <td class="<%= result_status %>"><a href="<%= vendor_path(vendor.id) %>"><%= vendor.name %></a></td>
                <td><span class="<%= dot_color %>"><%= vendor.count_passing %></span> <span class="q">/ <%= vendor.products.size %></span></td>
                <td><%= vendor.poc %></td>
                <td><%= vendor.proctor %></td>
                <td><%= link_to 'delete', { :action => 'destroy', :id => vendor }, :class => 'cmd', :method => :delete, :confirm => 'Are you sure?' %></td>
              </tr>
            </tbody>
          <% end %>
        <% end %>
      </table>
    </section>

    <%= render :partial=>"shared/legend" %>
  </div>
</div>
