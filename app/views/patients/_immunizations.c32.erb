      <component>
        <!--Immunizations-->
        <section>
          <templateId root="2.16.840.1.113883.3.88.11.83.117" assigningAuthorityName="HITSP/C83"/>
          <templateId root="1.3.6.1.4.1.19376.1.5.3.1.3.23" assigningAuthorityName="IHE PCC"/>
          <templateId root="2.16.840.1.113883.10.20.1.6" assigningAuthorityName="HL7 CCD"/>
          <!--Immunizations section template-->
          <code code="11369-6" codeSystem="2.16.840.1.113883.6.1" codeSystemName="LOINC" displayName="History of immunizations"/>
          <title>Immunizations</title>
          <%= render :partial => 'narrative_block', :locals => {:entries => entries, :section => 'immunizations'} %>
          <% entries.each_with_index do |entry, i| -%>
          <entry typeCode="DRIV">
            <substanceAdministration classCode="SBADM" moodCode="EVN">
              <templateId root="2.16.840.1.113883.10.20.1.24"/>
              <!-- Medication activity template -->
              <id root="<%= UUID.generate %>"/>
              <text>
                <reference value="#immunizations-desc-<%= i %>"/>
              </text>
              <statusCode code="completed"/>
              <effectiveTime value="<%= Time.at(entry.time).utc.to_formatted_s(:number) %>"/>
              <doseQuantity nullFlavor="UNK"/>
              <consumable>
                <manufacturedProduct>
                  <templateId root="2.16.840.1.113883.10.20.1.53"/>
                  <!-- Product template -->
                  <manufacturedMaterial>
                    <%= raw code_display(entry) %>
                  </manufacturedMaterial>
                </manufacturedProduct>
              </consumable>
            </substanceAdministration>
          </entry>
          <% end -%>
        </section>
      </component>